<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>The Michel Royale â€” Blackjack</title>

<style>
  /* ---------- Michel Royale Theme ---------- */
  body {
    font-family: 'Segoe UI', sans-serif;
    background: radial-gradient(circle at center, #033018, #010f08);
    color: #f8f8f8;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }

  h1, h2, h3 {
    font-weight: 600;
    letter-spacing: 1px;
  }

  #table {
    max-width: 800px;
    margin: 40px auto;
    background: rgba(0,0,0,0.6);
    border: 2px solid #d4af37;
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 0 30px rgba(0,0,0,.7);
    opacity: 1;
    transform: scale(1);
  }

  .hand {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }

  .hand img {
    width: 110px;
    margin: 5px;
    border-radius: 8px;
    box-shadow: 0 3px 6px rgba(0,0,0,.4);
  }

  #status {
    font-size: 24px;
    margin: 15px 0;
    font-weight: bold;
    color: #d4af37;
  }

  /* ---------- Buttons ---------- */
  button {
    background: #d4af37;
    color: black;
    padding: 12px 20px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    margin: 8px;
    cursor: pointer;
    transition: background .3s;
  }
  button:hover {
    background: #f5d77b;
  }
  button:disabled {
    background: #3a3a3a;
    color: #888;
    cursor: not-allowed;
  }

  /* ---------- Betting Chips ---------- */
  #chips {
    margin: 20px 0;
  }
  .chip {
    display: inline-block;
    width: 70px;
    height: 70px;
    background: #111;
    border-radius: 50%;
    border: 3px solid #d4af37;
    margin: 10px;
    line-height: 66px;
    font-size: 20px;
    font-weight: 600;
    text-align: center;
    cursor: pointer;
    transition: transform .2s;
  }
  .chip:hover { transform: scale(1.1); }

  #betDisplay {
    font-size: 22px;
    margin: 10px 0;
    color: #f5d77b;
  }

  #bankroll {
    font-size: 20px;
    margin-bottom: 10px;
  }

  @media (max-width: 600px) {
    .hand img { width: 85px; }
    .chip { width: 60px; height: 60px; font-size: 18px; line-height: 56px; }
  }
</style>
</head>
<body>
<!-- â–‘â–‘â–‘ GAME TABLE â–‘â–‘â–‘ -->
<div id="table">
  <h2 style="text-align:center; color:#d4af37;">â™  The Michel Royale â€” Blackjack â™£</h2>

  <div id="bankroll"></div>
  <div id="betDisplay">Current Bet: $0</div>

  <div id="chips">
    <div class="chip" data-value="5">$5</div>
    <div class="chip" data-value="10">$10</div>
    <div class="chip" data-value="25">$25</div>
    <div class="chip" data-value="50">$50</div>
    <div class="chip" data-value="100">$100</div>
  </div>

  <button id="dealBtn">Deal</button>

  <h3>Dealer</h3>
  <div class="hand" id="dealer-hand"></div>

  <h3>You</h3>
  <div class="hand" id="player-hand"></div>

  <div id="status"></div>

  <button id="hitBtn" disabled>Hit</button>
  <button id="standBtn" disabled>Stand</button>
  <button id="restartBtn" style="display:none;">New Hand</button>
</div>

<script>
/* ---------- LocalStorage Setup ---------- */
const LS = {
  bankroll: "michel_royale_bankroll",
  hands: "michel_royale_hands_played",
  streak: "michel_royale_win_streak",
};

let bankroll = parseInt(localStorage.getItem(LS.bankroll)) || 500;
let handsPlayed = parseInt(localStorage.getItem(LS.hands)) || 0;
let winStreak = parseInt(localStorage.getItem(LS.streak)) || 0;
let inRound = false;

/* ---------- Game Variables ---------- */
let deck = [];
let playerCards = [];
let dealerCards = [];
let currentBet = 0;
let gameOver = false;

/* ---------- Local Deck ---------- */
function buildDeck() {
  const suits = ["HEARTS", "DIAMONDS", "CLUBS", "SPADES"];
  const values = [
    "ACE", "2", "3", "4", "5", "6", "7", "8", "9", "10", "JACK", "QUEEN", "KING"
  ];

  return suits.flatMap(suit => values.map(value => {
    const codeValue = value === "10" ? "0" : value[0];
    const code = `${codeValue}${suit[0]}`;

    return {
      value,
      suit,
      image: `https://deckofcardsapi.com/static/img/${code}.png`,
    };
  }));
}

function shuffleDeck(cards) {
  for (let i = cards.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [cards[i], cards[j]] = [cards[j], cards[i]];
  }
  return cards;
}

function newDeck() {
  deck = shuffleDeck(buildDeck());
}

function draw(count = 1) {
  const drawn = [];
  for (let i = 0; i < count; i++) {
    if (deck.length === 0) newDeck();
    drawn.push(deck.pop());
  }
  return drawn;
}

/* ---------- Card Values ---------- */
function cardValue(card) {
  if (["KING","QUEEN","JACK"].includes(card.value)) return 10;
  if (card.value === "ACE") return 11;
  return parseInt(card.value);
}

function handValue(cards) {
  let total = cards.reduce((s,c)=>s+cardValue(c), 0);
  let aces = cards.filter(c=>c.value==="ACE").length;
  while (total > 21 && aces > 0) { total -= 10; aces--; }
  return total;
}

/* ---------- Rendering ---------- */
function render() {
  const dealerDiv = document.getElementById("dealer-hand");
  const playerDiv = document.getElementById("player-hand");
  dealerDiv.innerHTML = "";
  playerDiv.innerHTML = "";

  dealerCards.forEach((card,i)=>{
    const img=document.createElement("img");
    img.src = (i===0 && !gameOver) ?
      "https://deckofcardsapi.com/static/img/back.png" :
      card.image;
    dealerDiv.appendChild(img);
  });

  playerCards.forEach(card=>{
    const img=document.createElement("img");
    img.src = card.image;
    playerDiv.appendChild(img);
  });
}

/* ---------- UI Update ---------- */
function updateUI() {
  document.getElementById("bankroll").textContent = `Bankroll: $${bankroll}`;
  document.getElementById("betDisplay").textContent = `Current Bet: $${currentBet}`;
}

// Initialize UI on load
updateUI();

/* ---------- Betting Chips ---------- */
document.querySelectorAll(".chip").forEach(chip=>{
  chip.addEventListener("click", ()=>{
    if (inRound) return; // lock bets during an active hand
    const val = parseInt(chip.dataset.value);
    if (bankroll >= val) {
      currentBet += val;
      bankroll -= val;
      updateUI();
    }
  });
});

/* ---------- Deal Button ---------- */
document.getElementById("dealBtn").onclick = () => {
  if (currentBet === 0) {
    alert("Place a bet first!");
    return;
  }

  if (inRound) return;

  inRound = true;
  document.getElementById("dealBtn").disabled = true;

  document.getElementById("hitBtn").disabled = false;
  document.getElementById("standBtn").disabled = false;

  newDeck();
  playerCards = draw(2);
  dealerCards = draw(2);

  gameOver = false;
  document.getElementById("status").textContent = "";
  render();
};

/* ---------- Hit ---------- */
document.getElementById("hitBtn").onclick = () => {
  if (gameOver) return;
  const newCard = draw(1);
  playerCards.push(...newCard);

  if (handValue(playerCards) > 21) {
    endGame("bust");
  } else {
    render();
  }
};

/* ---------- Stand ---------- */
document.getElementById("standBtn").onclick = () => {
  gameOver = true;

  while (handValue(dealerCards) < 17) {
    const newCard = draw(1);
    dealerCards.push(...newCard);
  }

  determineWinner();
};

/* ---------- Determine Winner ---------- */
function determineWinner() {
  const dealer = handValue(dealerCards);
  const player = handValue(playerCards);

  if (player > 21) return endGame("bust");
  if (dealer > 21) return endGame("dealerBust");
  if (player > dealer) return endGame("player");
  if (player < dealer) return endGame("dealer");
  return endGame("push");
}

/* ---------- End Game ---------- */
function endGame(outcome) {
  gameOver = true;
  handsPlayed++;
  inRound = false;

  let status = "";
  switch(outcome) {
    case "bust":
      status = "âŒ You busted! Dealer wins.";
      winStreak = 0;
      break;
    case "dealerBust":
      status = "ðŸŽ‰ Dealer busts! You win!";
      bankroll += currentBet * 2;
      winStreak++;
      break;
    case "player":
      status = "ðŸŽ‰ You win!";
      bankroll += currentBet * 2;
      winStreak++;
      break;
    case "dealer":
      status = "âŒ Dealer wins.";
      winStreak = 0;
      break;
    case "push":
      status = "ðŸ¤ Push â€” bet returned.";
      bankroll += currentBet;
      break;
  }

  // Save stats
  localStorage.setItem(LS.bankroll, bankroll);
  localStorage.setItem(LS.hands, handsPlayed);
  localStorage.setItem(LS.streak, winStreak);

  currentBet = 0;
  document.getElementById("status").textContent = status;
  document.getElementById("dealBtn").disabled = false;
  document.getElementById("hitBtn").disabled = true;
  document.getElementById("standBtn").disabled = true;
  render();
  updateUI();
}

/* ---------- Restart ---------- */
document.getElementById("restartBtn").onclick = () => {
  location.reload();
};

</script>

</body>
</html>